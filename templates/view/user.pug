extends ../layout.pug
include ../mixins.pug

block breadcrumbs
  a.link.link-animated( href=`${ADDR_PREFIX}/` ) #{T('Home')}
  |  / 
  a.link.link-animated( href=`${ADDR_PREFIX}/users` ) #{T('Users')}
  |  / 
  span #{user.username}

block content
  script
    include /static/scripts/contacts.js

  h1.center Welcome to #{user.username}'s page
  div( align='center' )
    img.userIcon( alt=user.username, src=gravatarLink )
  p.center
    small Joined
      |  #{formatDate(new Date(user.created_at))}
      |  - Last seen #{formatDate(new Date(user.updated_at))}
      if !user.isContact && !user.isMe
        |  - 
        a.link.link-animated( onclick=`addContact('${user.username}')` ) #{T('Add to contacts')}
  
  hr

  h3 #{user.username}'s universes
  table.sheet.w-100
    thead
      th Name
      th Role
      th Created
      th Updated
    tbody
      each universe in universes
        tr
          td
            a.link.link-animated( href=`${ADDR_PREFIX}/universes/${universe.shortname}` ) #{universe.title}
          td
            //- +authorList(universe.authors, universe.author_permissions)
            case universe.author_permissions[user.id]
              when perms.READ
              when perms.COMMENT
                | Viewer
              when perms.WRITE
                | Author
              when perms.ADMIN
                | Admin
          td #{formatDate(universe.created_at, true)}
          td #{formatDate(universe.updated_at, true)}
  
  h3 #{user.username}'s recent updates
  table.sheet.w-100
    thead
      th Name
      th Type
      th Universe
      th Created
      th Updated